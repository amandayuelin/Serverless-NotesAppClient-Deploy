(this["webpackJsonpnotes-app-client"]=this["webpackJsonpnotes-app-client"]||[]).push([[0],{158:function(e,t,n){},160:function(e,t,n){},161:function(e,t,n){},219:function(e,t,n){},220:function(e,t,n){},221:function(e,t,n){},223:function(e,t,n){},224:function(e,t,n){},232:function(e,t,n){},238:function(e,t,n){},239:function(e,t,n){},240:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),r=n(53),s=n.n(r),i=(n(158),n(10)),o=n.n(i),u=n(17),l=n(13),j=n(66),b=(n(160),n(18)),d=n(92),p=Object(a.createContext)(null);function h(){return Object(a.useContext)(p)}function O(e){var t=e.toString();e instanceof Error||!e.message||(t=e.message),alert(t)}n(161);var x=n(250),f=n(84),m=n(45),g=n(3);function v(){var e=Object(a.useState)([]),t=Object(l.a)(e,2),n=t[0],c=t[1],r=h().isAuthenticated,s=Object(a.useState)(!0),i=Object(l.a)(s,2),j=i[0],b=i[1];function p(){return x.a.get("notes","/notes")}function v(e){return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(m.LinkContainer,{to:"/notes/new",children:Object(g.jsxs)(d.a.Item,{action:!0,className:"py-3 text-nowrap text-truncate",children:[Object(g.jsx)(f.b,{size:17}),Object(g.jsx)("span",{className:"ml-2 font-weight-bold",children:"Create a new note"})]})}),e.map((function(e){var t=e.noteId,n=e.content,a=e.createdAt;return Object(g.jsx)(m.LinkContainer,{to:"/notes/".concat(t),children:Object(g.jsxs)(d.a.Item,{action:!0,children:[Object(g.jsx)("span",{className:"font-weight-bold",children:n.trim().split("\n")[0]}),Object(g.jsx)("br",{}),Object(g.jsxs)("span",{className:"text-muted",children:["Created: ",new Date(a).toLocaleString()]})]})},t)}))]})}return Object(a.useEffect)((function(){function e(){return(e=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,p();case 5:t=e.sent,c(t),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),O(e.t0);case 12:b(!1);case 13:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[r]),Object(g.jsx)("div",{className:"Home",children:r?Object(g.jsxs)("div",{className:"notes",children:[Object(g.jsx)("h2",{className:"pb-3 mt-4 mb-3 border-bottom",children:"Your Notes"}),Object(g.jsx)(d.a,{children:!j&&v(n)})]}):Object(g.jsxs)("div",{className:"lander",children:[Object(g.jsx)("h1",{children:"Scratch"}),Object(g.jsx)("p",{className:"text-muted",children:"A simple note taking app"})]})})}n(219);function w(){return Object(g.jsx)("div",{className:"NotFound text-center",children:Object(g.jsx)("h3",{children:"Sorry, page not found!"})})}var y=n(100),k=n(8),C=n(29),S=n(41),I=n(142);n(220);function L(e){var t=e.isLoading,n=e.className,a=void 0===n?"":n,c=e.disabled,r=void 0!==c&&c,s=Object(S.a)(e,["isLoading","className","disabled"]);return Object(g.jsxs)(I.a,Object(C.a)(Object(C.a)({disabled:r||t,className:"LoaderButton ".concat(a)},s),{},{children:[t&&Object(g.jsx)(f.a,{className:"spinning"}),s.children]}))}var N=n(78);function E(e){var t=Object(a.useState)(e),n=Object(l.a)(t,2),c=n[0],r=n[1];return[c,function(e){r(Object(C.a)(Object(C.a)({},c),{},Object(N.a)({},e.target.id,e.target.value)))}]}n(221);function T(){var e=h().userHasAuthenticated,t=Object(a.useState)(!1),n=Object(l.a)(t,2),c=n[0],r=n[1],s=E({email:"",password:""}),i=Object(l.a)(s,2),j=i[0],b=i[1];function d(){return(d=Object(u.a)(o.a.mark((function t(n){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),r(!0),t.prev=2,t.next=5,y.a.signIn(j.email,j.password);case 5:e(!0),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(2),O(t.t0),r(!1);case 12:case"end":return t.stop()}}),t,null,[[2,8]])})))).apply(this,arguments)}return Object(g.jsx)("div",{className:"Login",children:Object(g.jsxs)(k.a,{onSubmit:function(e){return d.apply(this,arguments)},children:[Object(g.jsxs)(k.a.Group,{size:"lg",controlId:"email",children:[Object(g.jsx)(k.a.Label,{children:"Email"}),Object(g.jsx)(k.a.Control,{autoFocus:!0,type:"email",value:j.email,onChange:b})]}),Object(g.jsxs)(k.a.Group,{size:"lg",controlId:"password",children:[Object(g.jsx)(k.a.Label,{children:"Password"}),Object(g.jsx)(k.a.Control,{type:"password",value:j.password,onChange:b})]}),Object(g.jsx)(L,{block:!0,size:"lg",type:"submit",isLoading:c,disabled:!(j.email.length>0&&j.password.length>0),children:"Login"})]})})}n(223);function A(){var e=E({email:"",password:"",confirmPassword:"",confirmationCode:""}),t=Object(l.a)(e,2),n=t[0],c=t[1],r=Object(b.k)(),s=Object(a.useState)(null),i=Object(l.a)(s,2),j=i[0],d=i[1],p=h().userHasAuthenticated,x=Object(a.useState)(!1),f=Object(l.a)(x,2),m=f[0],v=f[1];function w(e){return C.apply(this,arguments)}function C(){return(C=Object(u.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),v(!0),e.prev=2,e.next=5,y.a.signUp({username:n.email,password:n.password});case 5:a=e.sent,v(!1),d(a),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),O(e.t0),v(!1);case 14:case"end":return e.stop()}}),e,null,[[2,10]])})))).apply(this,arguments)}function S(e){return I.apply(this,arguments)}function I(){return(I=Object(u.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),v(!0),e.prev=2,e.next=5,y.a.confirmSignUp(n.email,n.confirmationCode);case 5:return e.next=7,y.a.signIn(n.email,n.password);case 7:p(!0),r.push("/"),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(2),O(e.t0),v(!1);case 15:case"end":return e.stop()}}),e,null,[[2,11]])})))).apply(this,arguments)}return Object(g.jsx)("div",{className:"Signup",children:null===j?Object(g.jsxs)(k.a,{onSubmit:w,children:[Object(g.jsxs)(k.a.Group,{controlId:"email",size:"lg",children:[Object(g.jsx)(k.a.Label,{children:"Email"}),Object(g.jsx)(k.a.Control,{autoFocus:!0,type:"email",value:n.email,onChange:c})]}),Object(g.jsxs)(k.a.Group,{controlId:"password",size:"lg",children:[Object(g.jsx)(k.a.Label,{children:"Password"}),Object(g.jsx)(k.a.Control,{type:"password",value:n.password,onChange:c})]}),Object(g.jsxs)(k.a.Group,{controlId:"confirmPassword",size:"lg",children:[Object(g.jsx)(k.a.Label,{children:"Confirm Password"}),Object(g.jsx)(k.a.Control,{type:"password",onChange:c,value:n.confirmPassword})]}),Object(g.jsx)(L,{block:!0,size:"lg",type:"submit",variant:"success",isLoading:m,disabled:!(n.email.length>0&&n.password.length>0&&n.password===n.confirmPassword),children:"Signup"})]}):Object(g.jsxs)(k.a,{onSubmit:S,children:[Object(g.jsxs)(k.a.Group,{controlId:"confirmationCode",size:"lg",children:[Object(g.jsx)(k.a.Label,{children:"Confirmation Code"}),Object(g.jsx)(k.a.Control,{autoFocus:!0,type:"tel",onChange:c,value:n.confirmationCode}),Object(g.jsx)(k.a.Text,{muted:!0,children:"Please check your email for the code."})]}),Object(g.jsx)(L,{block:!0,size:"lg",type:"submit",variant:"success",isLoading:m,disabled:!(n.confirmationCode.length>0),children:"Verify"})]})})}var P={STRIPE_KEY:"pk_test_51ITygdIZzTDUsK1IMtMnn5dJdpwdwolx8ewEtcAufIGrSynpMmEN93NRYDTAa1nTzjsQKe8xycN8fWA9nqh7vuJv003HuRFvMH",MAX_ATTACHMENT_SIZE:5e6,s3:{REGION:"us-east-1",BUCKET:"notes-api-prod-serverlessdeploymentbucket-rgtpf5xxpkb8"},apiGateway:{REGION:"us-east-1",URL:"https://ce9q4bqv23.execute-api.us-east-1.amazonaws.com/prod"},cognito:{REGION:"us-east-1",USER_POOL_ID:"us-east-1_v27SVSeju",APP_CLIENT_ID:"3kaoblbntn0u75veodekdhh7cu",IDENTITY_POOL_ID:"us-east-1:191eba37-5bf2-4359-a1ae-b093350a3aa3"}},_=(n(224),n(249));function D(e){return z.apply(this,arguments)}function z(){return(z=Object(u.a)(o.a.mark((function e(t){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(Date.now(),"-").concat(t.name),e.next=3,_.a.vault.put(n,t,{contentType:t.type});case 3:return a=e.sent,e.abrupt("return",a.key);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function G(){var e=Object(a.useRef)(null),t=Object(b.k)(),n=Object(a.useState)(""),c=Object(l.a)(n,2),r=c[0],s=c[1],i=Object(a.useState)(!1),j=Object(l.a)(i,2),d=j[0],p=j[1];function h(){return(h=Object(u.a)(o.a.mark((function n(a){var c;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a.preventDefault(),!(e.current&&e.current.size>P.MAX_ATTACHMENT_SIZE)){n.next=4;break}return alert("Please pick a file smaller than ".concat(P.MAX_ATTACHMENT_SIZE/1e6," MB.")),n.abrupt("return");case 4:if(p(!0),n.prev=5,!e.current){n.next=12;break}return n.next=9,D(e.current);case 9:n.t0=n.sent,n.next=13;break;case 12:n.t0=null;case 13:return c=n.t0,n.next=16,f({content:r,attachment:c});case 16:t.push("/"),n.next=23;break;case 19:n.prev=19,n.t1=n.catch(5),O(n.t1),p(!1);case 23:case"end":return n.stop()}}),n,null,[[5,19]])})))).apply(this,arguments)}function f(e){return x.a.post("notes","/notes",{body:e})}return Object(g.jsx)("div",{className:"NewNote",children:Object(g.jsxs)(k.a,{onSubmit:function(e){return h.apply(this,arguments)},children:[Object(g.jsx)(k.a.Group,{controlId:"content",children:Object(g.jsx)(k.a.Control,{value:r,as:"textarea",onChange:function(e){return s(e.target.value)}})}),Object(g.jsxs)(k.a.Group,{controlId:"file",children:[Object(g.jsx)(k.a.Label,{children:"Attachment"}),Object(g.jsx)(k.a.Control,{onChange:function(t){e.current=t.target.files[0]},type:"file"})]}),Object(g.jsx)(L,{block:!0,type:"submit",size:"lg",variant:"primary",isLoading:d,disabled:!(r.length>0),children:"Create"})]})})}n(232);function R(){var e,t=Object(a.useState)(!1),n=Object(l.a)(t,2),c=n[0],r=n[1],s=Object(a.useState)(!1),i=Object(l.a)(s,2),j=i[0],d=i[1],p=Object(a.useRef)(null),h=Object(b.m)().id,f=(Object(b.k)(),Object(a.useState)(null)),m=Object(l.a)(f,2),v=m[0],w=m[1],y=Object(a.useState)(""),C=Object(l.a)(y,2),S=C[0],I=C[1];function N(){return(N=Object(u.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!(p.current&&p.current.size>P.MAX_ATTACHMENT_SIZE)){e.next=4;break}return alert("Please pick a file smaller than ".concat(P.MAX_ATTACHMENT_SIZE/1e6," MB.")),e.abrupt("return");case 4:r(!0);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(){return(E=Object(u.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),window.confirm("Are you sure you want to delete this note?")){e.next=4;break}return e.abrupt("return");case 4:d(!0);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.useEffect)((function(){function e(){return x.a.get("notes","/notes/".concat(h))}function t(){return(t=Object(u.a)(o.a.mark((function t(){var n,a,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e();case 3:if(n=t.sent,a=n.content,!(c=n.attachment)){t.next=9;break}return t.next=8,_.a.vault.get(c);case 8:n.attachmentURL=t.sent;case 9:I(a),w(n),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),O(t.t0);case 16:case"end":return t.stop()}}),t,null,[[0,13]])})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[h]),Object(g.jsx)("div",{className:"Notes",children:v&&Object(g.jsxs)(k.a,{onSubmit:function(e){return N.apply(this,arguments)},children:[Object(g.jsx)(k.a.Group,{controlId:"content",children:Object(g.jsx)(k.a.Control,{as:"textarea",value:S,onChange:function(e){return I(e.target.value)}})}),Object(g.jsxs)(k.a.Group,{controlId:"file",children:[Object(g.jsx)(k.a.Label,{children:"Attachment"}),v.attachment&&Object(g.jsx)("p",{children:Object(g.jsx)("a",{target:"_blank",rel:"noopener noreferrer",href:v.attachmentURL,children:(e=v.attachment,e.replace(/^\w+-/,""))})}),Object(g.jsx)(k.a.Control,{onChange:function(e){p.current=e.target.files[0]},type:"file"})]}),Object(g.jsx)(L,{block:!0,size:"lg",type:"submit",isLoading:c,disabled:!(S.length>0),children:"Save"}),Object(g.jsx)(L,{block:!0,size:"lg",variant:"danger",onClick:function(e){return E.apply(this,arguments)},isLoading:j,children:"Delete"})]})})}var M=n(56);n(238);var F=Object(M.injectStripe)((function(e){var t=e.isLoading,n=e.onSubmit,c=Object(S.a)(e,["isLoading","onSubmit"]),r=E({name:"",storage:""}),s=Object(l.a)(r,2),i=s[0],j=s[1],b=Object(a.useState)(!1),d=Object(l.a)(b,2),p=d[0],h=d[1],O=Object(a.useState)(!1),x=Object(l.a)(O,2),f=x[0],m=x[1];function v(){return(v=Object(u.a)(o.a.mark((function e(t){var a,r,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),h(!0),e.next=4,c.stripe.createToken({name:i.name});case 4:a=e.sent,r=a.token,s=a.error,h(!1),n(i.storage,{token:r,error:s});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return t=p||t,Object(g.jsxs)(k.a,{className:"BillingForm",onSubmit:function(e){return v.apply(this,arguments)},children:[Object(g.jsxs)(k.a.Group,{size:"lg",controlId:"storage",children:[Object(g.jsx)(k.a.Label,{children:"Storage"}),Object(g.jsx)(k.a.Control,{min:"0",type:"number",value:i.storage,onChange:j,placeholder:"Number of notes to store"})]}),Object(g.jsx)("hr",{}),Object(g.jsxs)(k.a.Group,{size:"lg",controlId:"name",children:[Object(g.jsx)(k.a.Label,{children:"Cardholder's name"}),Object(g.jsx)(k.a.Control,{type:"text",value:i.name,onChange:j,placeholder:"Name on the card"})]}),Object(g.jsx)(k.a.Label,{children:"Credit Card Info"}),Object(g.jsx)(M.CardElement,{className:"card-field",onChange:function(e){return m(e.complete)},style:{base:{fontSize:"16px",color:"#495057",fontFamily:"'Open Sans', sans-serif"}}}),Object(g.jsx)(L,{block:!0,size:"lg",type:"submit",isLoading:t,disabled:!(""!==i.name&&""!==i.storage&&f),children:"Purchase"})]})}));n(239);function U(){var e=Object(b.k)(),t=Object(a.useState)(!1),n=Object(l.a)(t,2),c=n[0],r=n[1],s=Object(a.useState)(null),i=Object(l.a)(s,2),j=i[0],d=i[1];function p(e){return x.a.post("notes","/billing",{body:e})}function h(){return(h=Object(u.a)(o.a.mark((function t(n,a){var c,s;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c=a.token,!(s=a.error)){t.next=4;break}return O(s),t.abrupt("return");case 4:return r(!0),t.prev=5,t.next=8,p({storage:n,source:c.id});case 8:alert("Your card has been charged successfully!"),e.push("/"),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(5),O(t.t0),r(!1);case 16:case"end":return t.stop()}}),t,null,[[5,12]])})))).apply(this,arguments)}return Object(a.useEffect)((function(){d(window.Stripe(P.STRIPE_KEY))}),[]),Object(g.jsx)("div",{className:"Settings",children:Object(g.jsx)(M.StripeProvider,{stripe:j,children:Object(g.jsx)(M.Elements,{fonts:[{cssSrc:"https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700,800"}],children:Object(g.jsx)(F,{isLoading:c,onSubmit:function(e,t){return h.apply(this,arguments)}})})})})}function H(e){var t=e.children,n=Object(S.a)(e,["children"]),a=Object(b.l)(),c=a.pathname,r=a.search,s=h().isAuthenticated;return Object(g.jsx)(b.d,Object(C.a)(Object(C.a)({},n),{},{children:s?t:Object(g.jsx)(b.c,{to:"/login?redirect=".concat(c).concat(r)})}))}function B(e){var t=e.children,n=Object(S.a)(e,["children"]),a=h().isAuthenticated,c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location.href;e=e.replace(/[[]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)","i").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}("redirect");return Object(g.jsx)(b.d,Object(C.a)(Object(C.a)({},n),{},{children:a?Object(g.jsx)(b.c,{to:""===c||null===c?"/":c}):t}))}function Y(){return Object(g.jsxs)(b.g,{children:[Object(g.jsx)(b.d,{exact:!0,path:"/",children:Object(g.jsx)(v,{})}),Object(g.jsx)(B,{exact:!0,path:"/login",children:Object(g.jsx)(T,{})}),Object(g.jsx)(B,{exact:!0,path:"/signup",children:Object(g.jsx)(A,{})}),Object(g.jsx)(H,{exact:!0,path:"/settings",children:Object(g.jsx)(U,{})}),Object(g.jsx)(H,{exact:!0,path:"/notes/new",children:Object(g.jsx)(G,{})}),Object(g.jsx)(H,{exact:!0,path:"/notes/:id",children:Object(g.jsx)(R,{})}),Object(g.jsx)(b.d,{children:Object(g.jsx)(w,{})})]})}var K=n(60);var Z=function(){var e=Object(b.k)(),t=Object(a.useState)(!0),n=Object(l.a)(t,2),c=n[0],r=n[1],s=Object(a.useState)(!1),i=Object(l.a)(s,2),d=i[0],h=i[1];function x(){return(x=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.a.currentSession();case 3:h(!0),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),"No current user"!==e.t0&&O(e.t0);case 9:r(!1);case 10:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}function f(){return(f=Object(u.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y.a.signOut();case 2:h(!1),e.push("/login");case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(a.useEffect)((function(){!function(){x.apply(this,arguments)}()}),[]),!c&&Object(g.jsxs)("div",{className:"App container py-3",children:[Object(g.jsxs)(j.a,{collapseOnSelect:!0,bg:"light",expand:"md",className:"mb-3",children:[Object(g.jsx)(m.LinkContainer,{to:"/",children:Object(g.jsx)(j.a.Brand,{className:"font-weight-bold text-muted",children:"Scratch"})}),Object(g.jsx)(j.a.Toggle,{}),Object(g.jsx)(j.a.Collapse,{className:"justify-content-end",children:Object(g.jsx)(K.a,{activeKey:window.location.pathname,children:d?Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(m.LinkContainer,{to:"/settings",children:Object(g.jsx)(K.a.Link,{children:"Settings"})}),Object(g.jsx)(K.a.Link,{onClick:function(){return f.apply(this,arguments)},children:"Logout"})]}):Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(m.LinkContainer,{to:"/signup",children:Object(g.jsx)(K.a.Link,{children:"Signup"})}),Object(g.jsx)(m.LinkContainer,{to:"/login",children:Object(g.jsx)(K.a.Link,{children:"Login"})})]})})})]}),Object(g.jsx)(p.Provider,{value:{isAuthenticated:d,userHasAuthenticated:h},children:Object(g.jsx)(Y,{})})]})},X=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,251)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),a(e),c(e),r(e),s(e)}))},J=n(27);n(33).a.configure({Auth:{mandatorySignIn:!0,region:P.cognito.REGION,userPoolId:P.cognito.USER_POOL_ID,identityPoolId:P.cognito.IDENTITY_POOL_ID,userPoolWebClientId:P.cognito.APP_CLIENT_ID},Storage:{region:P.s3.REGION,bucket:P.s3.BUCKET,identityPoolId:P.cognito.IDENTITY_POOL_ID},API:{endpoints:[{name:"notes",endpoint:P.apiGateway.URL,region:P.apiGateway.REGION}]}}),s.a.render(Object(g.jsx)(c.a.StrictMode,{children:Object(g.jsx)(J.BrowserRouter,{children:Object(g.jsx)(Z,{})})}),document.getElementById("root")),X()}},[[240,1,2]]]);
//# sourceMappingURL=main.ef0727cb.chunk.js.map